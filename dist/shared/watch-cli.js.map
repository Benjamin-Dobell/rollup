{"version":3,"file":"watch-cli.js","sources":["../../node_modules/time-zone/index.js","../../node_modules/date-time/index.js","../../node_modules/signal-exit/signals.js","../../node_modules/signal-exit/index.js","../../cli/run/resetScreen.ts","../../cli/run/watch-cli.ts"],"sourcesContent":["'use strict';\nmodule.exports = date => {\n\tconst offset = (date || new Date()).getTimezoneOffset();\n\tconst absOffset = Math.abs(offset);\n\tconst hours = Math.floor(absOffset / 60);\n\tconst minutes = absOffset % 60;\n\tconst minutesOut = minutes > 0 ? ':' + ('0' + minutes).slice(-2) : '';\n\n\treturn (offset < 0 ? '+' : '-') + hours + minutesOut;\n};\n","'use strict';\nconst timeZone = require('time-zone');\n\nconst dateTime = options => {\n\toptions = Object.assign({\n\t\tdate: new Date(),\n\t\tlocal: true,\n\t\tshowTimeZone: false,\n\t\tshowMilliseconds: false\n\t}, options);\n\n\tlet {date} = options;\n\n\tif (options.local) {\n\t\t// Offset the date so it will return the correct value when getting the ISO string\n\t\tdate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000));\n\t}\n\n\tlet end = '';\n\n\tif (options.showTimeZone) {\n\t\tend = ' UTC' + (options.local ? timeZone(date) : '');\n\t}\n\n\tif (options.showMilliseconds && date.getUTCMilliseconds() > 0) {\n\t\tend = ` ${date.getUTCMilliseconds()}ms${end}`;\n\t}\n\n\treturn date\n\t\t.toISOString()\n\t\t.replace(/T/, ' ')\n\t\t.replace(/\\..+/, end);\n};\n\nmodule.exports = dateTime;\n// TODO: Remove this for the next major release\nmodule.exports.default = dateTime;\n","// This is not the set of all possible signals.\n//\n// It IS, however, the set of all signals that trigger\n// an exit on either Linux or BSD systems.  Linux is a\n// superset of the signal names supported on BSD, and\n// the unknown signals just fail to register, so we can\n// catch that easily enough.\n//\n// Don't bother with SIGKILL.  It's uncatchable, which\n// means that we can't fire any callbacks anyway.\n//\n// If a user does happen to register a handler on a non-\n// fatal signal like SIGWINCH or something, and then\n// exit, it'll end up firing `process.emit('exit')`, so\n// the handler will be fired anyway.\n//\n// SIGBUS, SIGFPE, SIGSEGV and SIGILL, when not raised\n// artificially, inherently leave the process in a\n// state from which it is not safe to try and enter JS\n// listeners.\nmodule.exports = [\n  'SIGABRT',\n  'SIGALRM',\n  'SIGHUP',\n  'SIGINT',\n  'SIGTERM'\n]\n\nif (process.platform !== 'win32') {\n  module.exports.push(\n    'SIGVTALRM',\n    'SIGXCPU',\n    'SIGXFSZ',\n    'SIGUSR2',\n    'SIGTRAP',\n    'SIGSYS',\n    'SIGQUIT',\n    'SIGIOT'\n    // should detect profiler and enable/disable accordingly.\n    // see #21\n    // 'SIGPROF'\n  )\n}\n\nif (process.platform === 'linux') {\n  module.exports.push(\n    'SIGIO',\n    'SIGPOLL',\n    'SIGPWR',\n    'SIGSTKFLT',\n    'SIGUNUSED'\n  )\n}\n","// Note: since nyc uses this module to output coverage, any lines\n// that are in the direct sync flow of nyc's outputCoverage are\n// ignored, since we can never get coverage for them.\nvar assert = require('assert')\nvar signals = require('./signals.js')\nvar isWin = /^win/i.test(process.platform)\n\nvar EE = require('events')\n/* istanbul ignore if */\nif (typeof EE !== 'function') {\n  EE = EE.EventEmitter\n}\n\nvar emitter\nif (process.__signal_exit_emitter__) {\n  emitter = process.__signal_exit_emitter__\n} else {\n  emitter = process.__signal_exit_emitter__ = new EE()\n  emitter.count = 0\n  emitter.emitted = {}\n}\n\n// Because this emitter is a global, we have to check to see if a\n// previous version of this library failed to enable infinite listeners.\n// I know what you're about to say.  But literally everything about\n// signal-exit is a compromise with evil.  Get used to it.\nif (!emitter.infinite) {\n  emitter.setMaxListeners(Infinity)\n  emitter.infinite = true\n}\n\nmodule.exports = function (cb, opts) {\n  assert.equal(typeof cb, 'function', 'a callback must be provided for exit handler')\n\n  if (loaded === false) {\n    load()\n  }\n\n  var ev = 'exit'\n  if (opts && opts.alwaysLast) {\n    ev = 'afterexit'\n  }\n\n  var remove = function () {\n    emitter.removeListener(ev, cb)\n    if (emitter.listeners('exit').length === 0 &&\n        emitter.listeners('afterexit').length === 0) {\n      unload()\n    }\n  }\n  emitter.on(ev, cb)\n\n  return remove\n}\n\nmodule.exports.unload = unload\nfunction unload () {\n  if (!loaded) {\n    return\n  }\n  loaded = false\n\n  signals.forEach(function (sig) {\n    try {\n      process.removeListener(sig, sigListeners[sig])\n    } catch (er) {}\n  })\n  process.emit = originalProcessEmit\n  process.reallyExit = originalProcessReallyExit\n  emitter.count -= 1\n}\n\nfunction emit (event, code, signal) {\n  if (emitter.emitted[event]) {\n    return\n  }\n  emitter.emitted[event] = true\n  emitter.emit(event, code, signal)\n}\n\n// { <signal>: <listener fn>, ... }\nvar sigListeners = {}\nsignals.forEach(function (sig) {\n  sigListeners[sig] = function listener () {\n    // If there are no other listeners, an exit is coming!\n    // Simplest way: remove us and then re-send the signal.\n    // We know that this will kill the process, so we can\n    // safely emit now.\n    var listeners = process.listeners(sig)\n    if (listeners.length === emitter.count) {\n      unload()\n      emit('exit', null, sig)\n      /* istanbul ignore next */\n      emit('afterexit', null, sig)\n      /* istanbul ignore next */\n      if (isWin && sig === 'SIGHUP') {\n        // \"SIGHUP\" throws an `ENOSYS` error on Windows,\n        // so use a supported signal instead\n        sig = 'SIGINT'\n      }\n      process.kill(process.pid, sig)\n    }\n  }\n})\n\nmodule.exports.signals = function () {\n  return signals\n}\n\nmodule.exports.load = load\n\nvar loaded = false\n\nfunction load () {\n  if (loaded) {\n    return\n  }\n  loaded = true\n\n  // This is the number of onSignalExit's that are in play.\n  // It's important so that we can count the correct number of\n  // listeners on signals, and don't wait for the other one to\n  // handle it instead of us.\n  emitter.count += 1\n\n  signals = signals.filter(function (sig) {\n    try {\n      process.on(sig, sigListeners[sig])\n      return true\n    } catch (er) {\n      return false\n    }\n  })\n\n  process.emit = processEmit\n  process.reallyExit = processReallyExit\n}\n\nvar originalProcessReallyExit = process.reallyExit\nfunction processReallyExit (code) {\n  process.exitCode = code || 0\n  emit('exit', process.exitCode, null)\n  /* istanbul ignore next */\n  emit('afterexit', process.exitCode, null)\n  /* istanbul ignore next */\n  originalProcessReallyExit.call(process, process.exitCode)\n}\n\nvar originalProcessEmit = process.emit\nfunction processEmit (ev, arg) {\n  if (ev === 'exit') {\n    if (arg !== undefined) {\n      process.exitCode = arg\n    }\n    var ret = originalProcessEmit.apply(this, arguments)\n    emit('exit', process.exitCode, null)\n    /* istanbul ignore next */\n    emit('afterexit', process.exitCode, null)\n    return ret\n  } else {\n    return originalProcessEmit.apply(this, arguments)\n  }\n}\n","import { MergedRollupOptions } from '../../src/rollup/types';\nimport { stderr } from '../logging';\n\nconst CLEAR_SCREEN = '\\u001Bc';\n\nexport function getResetScreen(\n\tconfigs: MergedRollupOptions[],\n\tallowClearScreen: boolean | undefined\n) {\n\tlet clearScreen = allowClearScreen;\n\tfor (const config of configs) {\n\t\tif (config.watch && config.watch.clearScreen === false) {\n\t\t\tclearScreen = false;\n\t\t}\n\t}\n\tif (clearScreen) {\n\t\treturn (heading: string) => stderr(CLEAR_SCREEN + heading);\n\t}\n\n\tlet firstRun = true;\n\treturn (heading: string) => {\n\t\tif (firstRun) {\n\t\t\tstderr(heading);\n\t\t\tfirstRun = false;\n\t\t}\n\t};\n}\n","import chokidar from 'chokidar';\nimport { bold, cyan, green, underline } from 'colorette';\nimport dateTime from 'date-time';\nimport fs from 'fs';\nimport ms from 'pretty-ms';\nimport onExit from 'signal-exit';\nimport * as rollup from '../../src/node-entry';\nimport { MergedRollupOptions, RollupWatcher } from '../../src/rollup/types';\nimport relativeId from '../../src/utils/relativeId';\nimport { handleError, stderr } from '../logging';\nimport { BatchWarnings } from './batchWarnings';\nimport { getConfigPath } from './getConfigPath';\nimport loadAndParseConfigFile from './loadConfigFile';\nimport loadConfigFromCommand from './loadConfigFromCommand';\nimport { getResetScreen } from './resetScreen';\nimport { printTimings } from './timings';\n\nexport async function watch(command: any) {\n\tprocess.env.ROLLUP_WATCH = 'true';\n\tconst isTTY = process.stderr.isTTY;\n\tconst silent = command.silent;\n\tlet configs: MergedRollupOptions[];\n\tlet warnings: BatchWarnings;\n\tlet watcher: RollupWatcher;\n\tlet configWatcher: fs.FSWatcher;\n\tconst configFile = command.config ? getConfigPath(command.config) : null;\n\n\tonExit(close);\n\tprocess.on('uncaughtException' as any, close);\n\tif (!process.stdin.isTTY) {\n\t\tprocess.stdin.on('end', close);\n\t\tprocess.stdin.resume();\n\t}\n\n\tif (configFile) {\n\t\tlet reloadingConfig = false;\n\t\tlet aborted = false;\n\t\tlet configFileData: string | null = null;\n\n\t\tconfigWatcher = chokidar.watch(configFile).on('change', () => reloadConfigFile());\n\t\tawait reloadConfigFile();\n\n\t\tasync function reloadConfigFile() {\n\t\t\ttry {\n\t\t\t\tconst newConfigFileData = fs.readFileSync(configFile!, 'utf-8');\n\t\t\t\tif (newConfigFileData === configFileData) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (reloadingConfig) {\n\t\t\t\t\taborted = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (configFileData) {\n\t\t\t\t\tstderr(`\\nReloading updated config...`);\n\t\t\t\t}\n\t\t\t\tconfigFileData = newConfigFileData;\n\t\t\t\treloadingConfig = true;\n\t\t\t\t({ options: configs, warnings } = await loadAndParseConfigFile(configFile!, command));\n\t\t\t\treloadingConfig = false;\n\t\t\t\tif (aborted) {\n\t\t\t\t\taborted = false;\n\t\t\t\t\treloadConfigFile();\n\t\t\t\t} else {\n\t\t\t\t\tif (watcher) {\n\t\t\t\t\t\twatcher.close();\n\t\t\t\t\t}\n\t\t\t\t\tstart(configs);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconfigs = [];\n\t\t\t\treloadingConfig = false;\n\t\t\t\thandleError(err, true);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t({ options: configs, warnings } = await loadConfigFromCommand(command));\n\t\tstart(configs);\n\t}\n\n\t// tslint:disable-next-line:no-unnecessary-type-assertion\n\tconst resetScreen = getResetScreen(configs!, isTTY);\n\n\tfunction start(configs: MergedRollupOptions[]) {\n\t\ttry {\n\t\t\twatcher = rollup.watch(configs as any);\n\t\t} catch (err) {\n\t\t\treturn handleError(err);\n\t\t}\n\n\t\twatcher.on('event', event => {\n\t\t\tswitch (event.code) {\n\t\t\t\tcase 'ERROR':\n\t\t\t\t\twarnings.flush();\n\t\t\t\t\thandleError(event.error, true);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'START':\n\t\t\t\t\tif (!silent) {\n\t\t\t\t\t\tresetScreen(underline(`rollup v${rollup.VERSION}`));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'BUNDLE_START':\n\t\t\t\t\tif (!silent) {\n\t\t\t\t\t\tlet input = event.input;\n\t\t\t\t\t\tif (typeof input !== 'string') {\n\t\t\t\t\t\t\tinput = Array.isArray(input)\n\t\t\t\t\t\t\t\t? input.join(', ')\n\t\t\t\t\t\t\t\t: Object.keys(input as Record<string, string>)\n\t\t\t\t\t\t\t\t\t\t.map(key => (input as Record<string, string>)[key])\n\t\t\t\t\t\t\t\t\t\t.join(', ');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstderr(\n\t\t\t\t\t\t\tcyan(`bundles ${bold(input)} → ${bold(event.output.map(relativeId).join(', '))}...`)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'BUNDLE_END':\n\t\t\t\t\twarnings.flush();\n\t\t\t\t\tif (!silent)\n\t\t\t\t\t\tstderr(\n\t\t\t\t\t\t\tgreen(\n\t\t\t\t\t\t\t\t`created ${bold(event.output.map(relativeId).join(', '))} in ${bold(\n\t\t\t\t\t\t\t\t\tms(event.duration)\n\t\t\t\t\t\t\t\t)}`\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\tif (event.result && event.result.getTimings) {\n\t\t\t\t\t\tprintTimings(event.result.getTimings());\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'END':\n\t\t\t\t\tif (!silent && isTTY) {\n\t\t\t\t\t\tstderr(`\\n[${dateTime()}] waiting for changes...`);\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ('result' in event && event.result) {\n\t\t\t\tevent.result.close().catch(error => handleError(error, true));\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction close(code: number | null) {\n\t\tprocess.removeListener('uncaughtException', close);\n\t\t// removing a non-existent listener is a no-op\n\t\tprocess.stdin.removeListener('end', close);\n\n\t\tif (watcher) watcher.close();\n\t\tif (configWatcher) configWatcher.close();\n\n\t\tif (code) {\n\t\t\tprocess.exit(code);\n\t\t}\n\t}\n}\n"],"names":["signals","require$$0","require$$1","stderr","getConfigPath","onExit","chokidar","loadAndParseConfigFile","handleError","loadConfigFromCommand","rollup.watch","underline","rollup.VERSION","cyan","bold","relativeId","green","ms","printTimings","dateTime"],"mappings":"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"}